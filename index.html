<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- Mobile-optimized viewport -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover"
    />
    <meta name="csrf-token" content="demo-csrf-token-12345" />

    <!-- Mobile browser optimizations -->
    <meta name="theme-color" content="#059669" />
    <meta name="msapplication-navbutton-color" content="#059669" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="Waste Finder" />

    <!-- SEO and social meta tags -->
    <meta
      name="description"
      content="Find dumpster rentals, waste disposal locations, and junk removal services near you. Compare prices and book local waste management services online."
    />
    <meta
      name="keywords"
      content="dumpster rental, junk removal, waste disposal, landfill, recycling center, transfer station, waste management, garbage disposal, dumpster near me"
    />

    <!-- Performance optimizations -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://maps.googleapis.com" />
    <link rel="dns-prefetch" href="https://www.google.com" />

    <title>Waste Finder - Landfill & Transfer Station Locator</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />

    <!-- Additional performance optimizations -->
    <meta name="color-scheme" content="light" />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      as="style"
      crossorigin
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      media="print"
      onload="this.media='all'"
    />

    <!-- Mobile optimizations -->
    <style>
      html {
        -webkit-text-size-adjust: 100%;
        -moz-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        text-size-adjust: 100%;
      }

      /* Improve tap highlighting */
      * {
        -webkit-tap-highlight-color: rgba(59, 130, 246, 0.1);
      }

      /* Better scrolling on iOS */
      body {
        -webkit-overflow-scrolling: touch;
        overscroll-behavior-y: contain;
        /* Fix iOS Safari header positioning */
        position: relative;
        overflow-x: hidden;
      }

      /* iOS Safari sticky header support */
      @supports (-webkit-touch-callout: none) {
        html {
          height: -webkit-fill-available;
        }
        body {
          height: -webkit-fill-available;
        }
      }

      /* Loading state */
      #root {
        min-height: 100vh;
      }

      .page-loading {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #ffffff;
      }

      .loading-spinner {
        display: inline-block;
        width: 2rem;
        height: 2rem;
        border: 3px solid #f3f4f6;
        border-radius: 50%;
        border-top-color: #059669;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Fix for iOS Safari bottom bar */
      .min-h-screen {
        min-height: 100vh;
        min-height: -webkit-fill-available;
      }

      /* Touch-friendly minimum sizes */
      button,
      input[type="button"],
      input[type="submit"],
      a {
        min-height: 44px;
        min-width: 44px;
      }

      /* Prevent zoom on form inputs (iOS) */
      input,
      textarea,
      select {
        font-size: 16px;
      }
    </style>
  </head>

  <body>
    <div id="root">
      <!-- Loading fallback -->
      <div class="page-loading">
        <div class="loading-spinner"></div>
      </div>
    </div>

    <!-- Block FullStory to prevent router conflicts -->
    <script>
      // Disable FullStory completely
      if (window.FS) {
        window.FS.shutdown();
        delete window.FS;
      }
      // Block FullStory loading
      window._fs_disabled = true;
      window._fs_debug = false;

      // Handle direct URL access for HashRouter
      (function () {
        const path = window.location.pathname;
        if (path !== "/" && !window.location.hash) {
          // Redirect paths like /pricing-calculator to #/pricing-calculator
          window.location.replace("/#" + path);
        }
      })();
    </script>

    <!-- Service Worker registration -->
    <script>
      if (
        "serviceWorker" in navigator &&
        window.location.protocol === "https:"
      ) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/sw.js")
            .then((registration) => console.log("SW registered"))
            .catch((error) => console.log("SW registration failed"));
        });
      }
    </script>

    <script type="module" src="/client/main.tsx"></script>

    <!-- Performance monitoring -->
    <script>
      if ("PerformanceObserver" in window) {
        const observer = new PerformanceObserver((list) => {
          for (const entry of list.getEntries()) {
            if (entry.entryType === "navigation") {
              console.log(
                "Page Load Time:",
                entry.loadEventEnd - entry.fetchStart + "ms",
              );
            }
          }
        });

        try {
          observer.observe({ type: "navigation", buffered: true });
        } catch (e) {
          // Browser doesn't support this observation type
        }
      }
    </script>
  </body>
</html>
